## TASK 2.2.4 [задание на stepik](https://stepik.org/lesson/308886/step/4?unit=291012)
Есть список городов, хранящийся в таблице **city**:

|city_id|	name_city      |
|-------|----------------|
|1      |	Москва         |
|2      | Санкт-Петербург|
|3      |	Владивосток    |

Необходимо в каждом городе провести выставку книг каждого автора в течение 2020 года. Дату проведения выставки выбрать
**случайным образом**. Создать запрос, который выведет город, автора и дату проведения выставки. Последний столбец назвать **Дата**.
Информацию вывести, отсортировав сначала в алфавитном порядке по названиям городов, а потом по убыванию дат проведения выставок.

**Структура таблицы**:

[![cx-2-11-1.jpg](https://i.postimg.cc/rpR42gJh/cx-2-11-1.jpg)](https://postimg.cc/R39hc72f)

___
**Пояснение:**

1. Для генерации **случайной даты** можно к первому числу года ('2020-01-01') прибавить целое случайное число в интервале от 0 до 365.
Генерации случайных чисел в интервале от 0 до 1 (не включительно) осуществляется с помощью функции [RAND()](https://oracleplsql.ru/mysql-function-rand.html). Если эту функцию
умножить на 365, то она будет генерировать вещественные числа от 0 до 365 (не включительно). Осталось только отбросить дробную
часть. Это можно сделать с помощью функции [FLOOR()](https://oracleplsql.ru/mysql-function-floor.html), которая возвращает наибольшее целое число, меньшее или равное
указанному числовому значению. Таким образом, случайное число от 0 до 365 можно получить с помощью выражения:

```SQL
FLOOR(RAND() * 365)
```

**Важно!** Даты должны быть за 2020 год, первое число года - 1 января 2020 года.

2. Для сложения  даты с числом используется функция [DATE_ADD()](https://oracleplsql.ru/mysql-function-date_add.html):

```SQL
DATE_ADD(дата, INTERVAL число единица_измерения),

где
  единица_измерения (использовать прописные буквы) – это день (DAY), месяц(MONTH), неделя(WEEK) и пр., 
  число – целое число,
  дата – значение даты или даты и времени.
```

Функция к **дате**  прибавляет указанное **число**, выраженное в днях, месяцах и пр. , в зависимости от заданного интервала, и возвращает новую дату.

Например:

```SQL
DATE_ADD('2020-02-02', INTERVAL 45 DAY) возвращает 18 марта 2020 года
DATE_ADD('2020-02-02', INTERVAL 6 MONTH) возвращает 2 августа 2020 года
```

***Еще вариант для postgresql***:

```SQL
to_date('2020-01-01', 'yyyy-mm-dd') + cast(floor(random() * 365) as int)
```
___
**Решение:**

```SQL
SELECT name_city, name_author,
       DATE_ADD('2020-01-01', INTERVAL FLOOR(RAND() * 365) DAY) AS 'Дата'
FROM city, author
ORDER BY name_city ASC, Дата DESC;
```
**Перевод на человеческий**:
```SQL
/*выбери столбцы name_city, name_author*/
/*создай новый столбец, в котором к указанной дате (2020-01-01 - начало 2020 года) прибавь случайное число -
случайное число сгенерируй и отбрось у него дробную часть, новый столбец назови "Дата"*/
/*всё вышеперечисленное выбери из таблиц city и author, соединяя каждую строку одной таблицы с каждой строкой другой таблицы*/
/*отсортируй сначала по названиям городов в алфавитном порядке, а затем по датам в порядке убывания*/
```

**Результат**

*Примечание: даты при каждом запуске получаются разными и не должны совпадать с приведенными значениями, 
расположение авторов в таблице тоже будет отличаться из-за сортировки по названиям городов и датам*

| name_city       | name_author      | Дата       |
|-----------------|------------------|------------|
| Владивосток     | Есенин С.А.      | 2020-10-17 |
| Владивосток     | Достоевский Ф.М. | 2020-08-22 |
| Владивосток     | Лермонтов М.Ю.   | 2020-07-21 |
| Владивосток     | Булгаков М.А.    | 2020-07-15 |
| Владивосток     | Пастернак Б.Л.   | 2020-05-07 |
| Москва          | Достоевский Ф.М. | 2020-12-10 |
| Москва          | Лермонтов М.Ю.   | 2020-06-20 |
| Москва          | Булгаков М.А.    | 2020-05-30 |
| Москва          | Есенин С.А.      | 2020-05-11 |
| Москва          | Пастернак Б.Л.   | 2020-04-24 |
| Санкт-Петербург | Достоевский Ф.М. | 2020-12-21 |
| Санкт-Петербург | Лермонтов М.Ю.   | 2020-10-28 |
| Санкт-Петербург | Булгаков М.А.    | 2020-10-20 |
| Санкт-Петербург | Пастернак Б.Л.   | 2020-09-02 |
| Санкт-Петербург | Есенин С.А.      | 2020-02-24 |

Affected rows: 15
