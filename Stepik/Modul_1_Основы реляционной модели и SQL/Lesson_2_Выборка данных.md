## Выборка всех данных из таблицы

Оператор языка SQL **SELECT** - основная строительная конструкция для создания любого, простого или сложного запроса к базе данных. 

Без него, как и без фундамента для постройки, невозможно получить ни одну выборку данных из базы.


Запрос с оператором SELECT для выбора **всех** столбцов таблицы имеет следующий синтаксис:

```SQL
SELECT * FROM имя_таблицы;  /*для выбора всех столбцов таблицы после слова SELECT нужно ставить звёздочку*/
```

Используется SQL запрос следующей структуры: 
- ключевое слово SELECT; 
- символ « *» ; 
- ключевое слово FROM; 
- имя таблицы.

Результатом является таблица, в которую включены все строки и столбцы указанной в запросе таблицы.

**Пример**

Выбрать все записи таблицы **book**.

*Запрос*:

```SQL
SELECT * FROM book;             /* вывести всю информацию из таблицы book */
```

*Результат*:

[![6.png](https://i.postimg.cc/50NVMBzg/6.png)](https://postimg.cc/WDKKGJXq)

___
## Выборка отдельных столбцов

Для выбора определённых столбцов таблицы нам потребуется вместо звёздочки перечислить через запятую **названия всех столбцов, которые требуется выбрать**:

```SQL
SELECT выбираемые_столбцы FROM имя_таблицы;
```

Используется SQL запрос следующей структуры: 

- ключевое слово SELECT ; 
- список столбцов таблицы через запятую; 
- ключевое слово FROM ; 
- имя таблицы.


Результатом является таблица, в которую включены все данные из указанных после SELECT столбцов исходной таблицы.

**Пример**

Выбрать названия книг и их количества из таблицы **book** .

*Запрос*:

```SQL
SELECT title, amount FROM book;           /*выбрать title, amount из таблицы book*/
```

*Результат*:

|title                  | amount |
|-----------------------|--------| 
| Мастер и Маргарита    | 3      | 
| Белая гвардия         | 5      | 
| Идиот                 | 10     | 
| Братья Карамазовы     | 2      | 
| Стихотворения и поэмы | 15     |

___
## Присвоение новых имен столбцам при формировании выборки

С помощью оператора **AS** можно отобрать данные из определенных столбцов таблицы и одновременно задать столбцам новые названия (псевдонимы) в результате выборки:

```SQL
SELECT выбираемый_столбец AS псевдоним
FROM имя_таблицы;
```

Используется SQL запрос следующей структуры: 

* ключевое слово SELECT ; 
* имя столбца;
* ключевое слово AS ; 
* новое название столбца (можно русскими буквами), выводимое в результате запроса, но это должно быть одно слово, если название состоит из двух слов – соединяйте их подчеркиванием, например, Количество_книг; 
* запятая; 
* имя столбца; 
.... 
* ключевое слово FROM ; 
* имя таблицы.


В одном запросе можно использовать и имена столбцов из таблицы, и новые названия.

Результатом является таблица, в которую включены все данные из указанных после SELECT столбцов исходной таблицы. Каждому столбцу в результате запроса присваивается новое имя, заданное после AS, или столбец получает имя столбца исходной таблицы, если AS отсутствует.


**Пример**

Выбрать все названия книг и их количество из таблицы **book** , для столбца **title** задать новое имя **Название**.

*Запрос*:

```SQL 
SELECT title AS Название, amount                /*выбрать title как Название, amount из таблицы book*/
FROM book;
```

*Результат*:

| Название              | amount |
|-----------------------|--------| 
| Мастер и Маргарита    | 3      |
| Белая гвардия         | 5      | 
| Идиот                 | 10     |
| Братья Карамазовы     | 2      |
| Стихотворения и поэмы | 15     |

___
## Выборка данных с созданием вычисляемого столбца

С помощью SQL запросов можно осуществлять вычисления по каждой строке таблицы с помощью вычисляемого столбца. Для него в списке полей после оператора **SELECT** указывается выражение и задается имя.

Выражение может включать имена столбцов, константы, знаки операций, встроенные функции.

Результатом является таблица, в которую включены все данные из указанных после **SELECT** столбцов, а также новый столбец, в каждой строке которого вычисляется заданное выражение.


**Пример**

Вывести всю информацию о книгах, а также для каждой позиции посчитать ее **стоимость** (произведение цены на количество). Вычисляемому столбцу дать имя **total**.


*Запрос*:

```SQL
SELECT title, author, price, amount,      /*выбрать title, author, price, amount,*/
       price * amount AS total            /*произведение цены на количество как total*/
FROM book;                                /*из таблицы bool*/
```

*Результат*: 


| title                 | author           | price  | amount | total   | 
|-----------------------|------------------|--------|--------|---------| 
| Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      | 2012.97 | 
| Белая гвардия         | Булгаков М.А.    | 540.50 | 5      | 2702.50 | 
| Идиот                 | Достоевский Ф.М. | 460.00 | 10     | 4600.00 | 
| Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 2      | 1598.02 | 
| Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     | 9750.00 |

___
## Выборка данных, вычисляемые столбцы, математические функции
В SQL реализовано множество  [математических функций](https://learn.microsoft.com/ru-ru/sql/t-sql/functions/mathematical-functions-transact-sql?view=sql-server-ver15) для работы с числовыми данными. В таблице приведены некоторые из них.

[![7.png](https://i.postimg.cc/kGvbFYR9/7.png)](https://postimg.cc/rRzsqJ9Y)

**Пояснение.**   Существуют разные способы округления чисел. В SQL реализовано математическое округление. Для округления вещественного числа нужно в записи числа выбрать разряд в дробной части, до которого производится округление. Цифра, записанная в выбранном разряде: не меняется, если следующая за ней справа цифра - 0, 1, 2, 3 или 4; увеличивается на единицу, если следующая за ней справа цифра - 5,6,7,8 или 9.


**Пример** 

Для каждой книги из таблицы **book** вычислим налог на добавленную стоимость (имя столбца **tax**) , который включен в цену и составляет k = 18%,  а также цену книги (**price_tax**) без него. Формулы для вычисления:

[![8.png](https://i.postimg.cc/Vs4fccw1/8.png)](https://postimg.cc/WtFLMCtf)

Эта формула НДС отвечает на вопрос "Какую сумму увеличили на 18%, чтобы получить текущее значение"


*Запрос*:

```SQL
SELECT title, price, 
       (price*18/100)/(1+18/100) AS tax, 
       price/(1+18/100) AS price_tax 
FROM book;
```

*Результат*:


| title                 | price  | tax            | price_tax  |
|-----------------------|--------|----------------|------------|
| Мастер и Маргарита    | 670.99 | 102.3544067797 | 568.635593 |
| Белая гвардия         | 540.50 | 82.4491525424  | 458.050847 |
| Идиот                 | 460.00 | 70.1694915254  | 389.830508 |
| Братья Карамазовы     | 799.01 | 121.8828813559 | 677.127119 |
| Стихотворения и поэмы | 650.00 | 99.1525423729  | 550.847458 |

Сумма налога и цена книги без налога – это деньги, поэтому количество знаков после запятой у этих чисел должно быть 2. Следовательно необходимо округлить полученные значения.


*Запрос*:

```SQL
SELECT title, 
       price, 
       ROUND((price*18/100)/(1+18/100),2) AS tax, 
       ROUND(price/(1+18/100),2) AS price_tax 
FROM book;
```

*Результат*:

| title                 | price  | tax    | price_tax |
|-----------------------|--------|--------|-----------|
| Мастер и Маргарита    | 670.99 | 102.35 | 568.64    |
| Белая гвардия         | 540.50 | 82.45  | 458.05    |
| Идиот                 | 460.00 | 70.17  | 389.83    |
| Братья Карамазовы     | 799.01 | 121.88 | 677.13    |
| Стихотворения и поэмы | 650.00 | 99.15  | 550.85    |
